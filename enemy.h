#pragma once
#include "gameNode.h"
#include "enemyState.h"

enum class CONDITION
{
	SEARCH,
	CLOSE
};

class enemy : public gameNode
{
protected:
	enemyState* _state;				//현재 클래스 상태
	CONDITION _condition;			//상태

	RECT _rc;						//에너미 렉트
	RECT _shadow;					//에너미 그림자 렉트
	RECT _attackRC;					//에너미 공격 렉트

	image* _image;					//에너미 이미지
	int _currentX, _currentY;		//프레임 x축 , y축
	int _frameCount;				//프레임 돌리는 용도

	float _x, _y;					//에너미 x, y축
	float _width, _height;			//에너미 너비, 높이
	float _jumpPower, _gravity;		//에너미 점프파워, 그래비티

	bool _right;					//오른쪽 향하는지
	bool _isHit;					//맞고 있는지
	bool _isStop;					//프레임 조절용
	bool _isLay;					//누웠는지

	int _hitCount;					//맞은 횟수
	int _layCount;					//누운 시간

	float _playerX, _playerY;		//플레이어 x, y축
	RECT _playerRC;					//플레이어 렉트
	RECT _playerAttack;				//플레이어 공격렉트

	enemyState*	_move;
	enemyState* _run;
	enemyState*	_attack;
	enemyState* _hit;
	enemyState* _down;
	enemyState* _beg;
	enemyState* _dizzy;

public:
	enemy();
	~enemy();

	virtual HRESULT init();
	virtual void release();
	virtual void update();
	virtual void render();

	virtual void directionCheck(RECT rc, float x, float y);
	//virtual void type() = 0;									//에너미 타입 지정 용도(이미지 때문에)
	void draw();												//프레임 돌리는 용도
	void pixelCollision();										//픽셀 충돌
	void addImage();											//이미지매니저 한곳에 모아두기


public:
	RECT getRC() { return _rc; }								//에너미 렉트 가져가기
	RECT getShadow() { return _shadow; }						//그림자 렉트 가져가기
	RECT getAtk() { return _attackRC; }						//공격 렉트 가져가기
	image* getImage() { return _image; }						//이미지 가져가기
	CONDITION getCondition() { return _condition; }				//CONDITION 가져가기

	float getX() { return _x; }									//x축 가져가기
	float getY() { return _y; }									//y축 가져가기

	bool getRight() { return _right; }							//_right 가져가기
	bool getStop() { return _isStop; }							//_isStop 가져가기
	bool getOuch() { return _isHit; }							//_isHit 가져가기
	bool getLay() { return _isLay; }							//_isLay 가져가기

	int getHitCount() { return _hitCount; }						//_hitCount 가져가기
	int getLayCount() { return _layCount; }						//_layCount 가져가기
	int getFrameX() { return _currentX; }						//프레임X 가져가기
	int getFrameY() { return _currentY; }						//프레임Y 가져가기
	

public:
	void setRC(float x, float y, float width, float height)		//에너미 렉트 설정해주기
	{
		_rc = RectMakeCenter(x, y, width, height);
	}

	void setAtk(float x, float y, float width, float height)	//에너미 공격 렉트 설정해주기
	{
		_attackRC = RectMakeCenter(x, y, width, height);
	}

	void setState(enemyState* state) { this->_state = state; }	//상태 클래스 변경해주기
	void setImage(image* image) { this->_image = image; }		//이미지 변경해주기

	void setX(float x) { _x = x; }								//x축 움직이게 하기
	void setY(float y) { _y = y; }								//y축 움직이게 하기

	void setStop(BOOL stop = FALSE) { _isStop = stop; }			//_isStop 세팅해주기
	void setOuch(BOOL hit = FALSE) { _isHit = hit; }			//_isHit 세팅해주기
	void setLay(BOOL lay = FALSE) { _isLay = lay; }				//_isLay 세팅해주기

	void setHitCount(int count) { _hitCount += count; }			//_hitCount 올려주기
	void setLayCount(int count) { _layCount += count; }			//_layCount 올려주기
	void setFrameX(int x) { _currentX = x; }					//프레임X 변경해주기
	void setFrameY(int y) { _currentY = y; }					//프레임y 변경해주기

	void setJump(float power) { _jumpPower = power; }			//점프파워 정해주기
	void setGravity(float g) { _gravity = g; }					//그래비티 정해주기


public:
	enemyState* getMove() { return _move; }						//상태 클래스 변경할 때 필요
	enemyState* getRun() { return _run; }
	enemyState* getAttack() { return _attack; }
	enemyState* getHit() { return _hit; }
	enemyState* getDown() { return _down; }
	enemyState* getDizzy() { return _dizzy; }
};